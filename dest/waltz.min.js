/*!
 * @license waltz v0.0.1
 * (c) 2014 sugarshin https://github.com/sugarshin
 * License: MIT
 */
(function(){var t,n,i,e,o={}.hasOwnProperty,r=function(t,n){return function(){return t.apply(n,arguments)}};e=window,n=function(){function t(){}return t.prototype.wait=function(t,n){return $.Deferred(function(i){return setTimeout(function(){return i.resolve(t)},n)}).promise()},t.prototype.addEvent=function(t,n,i){return t.addEventListener(n,i)},t.prototype.rmEvent=function(t,n,i){return t.removeEventListener(n,i)},t.prototype.extend=function(t){var n,i,e,r,s,u;for(t||(t={}),n=r=1,s=arguments.length;s>=1?s>r:r>s;n=s>=1?++r:--r)if(arguments[n]){u=arguments[n];for(i in u)o.call(u,i)&&(e=u[i],t[i]=arguments[n][i])}return t},t.prototype.getRandomInt=function(t,n){return Math.floor(Math.random()*(n-t+1))+t},t.prototype.remove=function(t){return t.parentNode.removeChild(t)},t}(),t=function(){function t(t,n){this.options=this.util.extend({},this.defaults,n),this.ctx=t}return t.prototype.defaults={x:0,y:0,frame:0,max:30,size:10,color:"#f1f1f1"},t.prototype.util=function(){return new n}(),t.prototype.render=function(){return this.ctx.beginPath(),this.ctx.fillStyle=this.options.color,this.ctx.arc(this.options.x,this.options.y,this.options.frame*this.options.size,0,2*Math.PI,!1),this.ctx.fill(),this},t.prototype.clear=function(){return this.ctx.clearRect(this.options.x,this.options.y,this.options.frame*this.options.size,0),this},t.prototype.progress=function(){return this.options.frame++,this},t}(),i=function(){function i(t,n){this.add=r(this.add,this),this.options=this.util.extend({},this.defaults,n),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.setField(),this.events()}var e,o;return o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),e=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){return window.clearTimeout(t)}}(),i.prototype.defaults={fps:60},i.prototype.util=function(){return new n}(),i.prototype.setField=function(){return this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this},i.prototype.start=function(){var t,n;return n=(new Date).getTime(),(t=function(i){return function(){var e,r,s,u,a,h;if(i._timerID=o(t),s=(new Date).getTime(),s-n>=100-i.options.fps&&null!=i.circles){for(i.ctx.clearRect(0,0,i.width,i.height),h=i.circles,r=u=0,a=h.length;a>u;r=++u)e=h[r],null!=e&&e.render().progress(),(null!=e?e.options.frame:void 0)>=(null!=e?e.options.max:void 0)&&i.circles.splice(r,1);return n=(new Date).getTime()}}}(this))(),this},i.prototype.stop=function(){return e(this._timerID),this},i.prototype.add=function(n){var i,e;return n.preventDefault(),"mousemove"===n.type?(i=n.x+this.util.getRandomInt(0,80),e=n.y+this.util.getRandomInt(0,80)):("touchstart"===n.type||"touchmove"===n.type)&&(i=n.touches[0].pageX+this.util.getRandomInt(0,80),e=n.touches[0].pageY+this.util.getRandomInt(0,80)),this.circles||(this.circles=[]),this.circles.push(new t(this.ctx,{x:i,y:e,size:this.util.getRandomInt(0,3),max:this.util.getRandomInt(5,25),color:"#"+this.util.getRandomInt(0,16777215).toString(16)})),this},i.prototype.events=function(){return this.util.addEvent(window,"resize",function(t){return function(){return t.setField()}}(this)),this.util.addEvent(window,"orientationchange",function(t){return function(){return t.setField()}}(this)),this.util.addEvent(window,"mousemove",this.add),this.util.addEvent(window,"touchstart",this.add),this.util.addEvent(window,"touchmove",this.add),this},i}(),e.Waltz||(e.Waltz=i)}).call(this);