/*!
 * @license Waltz v0.1.0
 * (c) 2014 sugarshin https://github.com/sugarshin
 * License: MIT
 */
(function(){var t,i,n,e,o={}.hasOwnProperty,r=function(t,i){return function(){return t.apply(i,arguments)}};e=window,i=function(){function t(){}return t.prototype.addEvent=function(t,i,n){return t.addEventListener(i,n)},t.prototype.rmEvent=function(t,i,n){return t.removeEventListener(i,n)},t.prototype.extend=function(t){var i,n,e,r,s,u;for(t||(t={}),i=r=1,s=arguments.length;s>=1?s>r:r>s;i=s>=1?++r:--r)if(arguments[i]){u=arguments[i];for(n in u)o.call(u,n)&&(e=u[n],t[n]=arguments[i][n])}return t},t.prototype.getRandomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},t.prototype.filter=function(){return Array.filter?Array.filter:function(t){"use strict";var i,n,e,o,r,s;if("undefined"==typeof this||null===this)throw new TypeError;if(o=Object(this),n=o.length>>>0,"function"!=typeof t)throw new TypeError;for(e=[],r=arguments[1],i=0;n>i;)i in o&&(s=o[i],t.call(r,s,i,o)&&e.push(s)),i++;return e}}(),t}(),t=function(){function t(t,i){this.options=this.util.extend({},this.defaults,i),this.ctx=t}return t.prototype.defaults={x:0,y:0,frame:0,max:30,size:10,color:"#f1f1f1"},t.prototype.util=function(){return new i}(),t.prototype.render=function(){return this.ctx.beginPath(),this.ctx.fillStyle=this.options.color,this.ctx.arc(this.options.x,this.options.y,this.options.frame*this.options.size,0,2*Math.PI,!1),this.ctx.fill(),this},t.prototype.clear=function(){return this.ctx.clearRect(this.options.x,this.options.y,this.options.frame*this.options.size,0),this},t.prototype.progress=function(){return this.options.frame++,this},t}(),n=function(){function n(t,i){this.add=r(this.add,this),this.options=this.util.extend({},this.defaults,i),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.setField(),this.events()}var e,o;return o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),e=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){return window.clearTimeout(t)}}(),n.prototype.defaults={fps:60},n.prototype.util=function(){return new i}(),n.prototype.setField=function(){return this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this},n.prototype.anime=function(){var t,i,n,e,o;for(this.ctx.clearRect(0,0,this.width,this.height),o=this.circles,i=n=0,e=o.length;e>n;i=++n)t=o[i],t.options.frame>=t.options.max?t=null:t.render().progress();return this.util.filter.call(this.circles,function(t){return t}),this},n.prototype.start=function(){var t,i;return i=(new Date).getTime(),(t=function(n){return function(){var e;return n._timerID=o(t),e=(new Date).getTime(),e-i>=100-n.options.fps&&null!=n.circles?(n.anime(),i=(new Date).getTime()):void 0}}(this))(),this},n.prototype.stop=function(){return e(this._timerID),this},n.prototype.add=function(i){var n,e;return i.preventDefault(),"mousemove"===i.type?(n=i.x+this.util.getRandomInt(0,80),e=i.y+this.util.getRandomInt(0,80)):("touchstart"===i.type||"touchmove"===i.type)&&(n=i.touches[0].pageX+this.util.getRandomInt(0,80),e=i.touches[0].pageY+this.util.getRandomInt(0,80)),this.circles||(this.circles=[]),this.circles.push(new t(this.ctx,{x:n,y:e,size:this.util.getRandomInt(0,3),max:this.util.getRandomInt(5,25),color:"#"+this.util.getRandomInt(0,16777215).toString(16)})),this},n.prototype.events=function(){return this.util.addEvent(window,"resize",function(t){return function(){return t.setField()}}(this)),this.util.addEvent(window,"orientationchange",function(t){return function(){return t.setField()}}(this)),this.util.addEvent(window,"mousemove",this.add),this.util.addEvent(window,"touchstart",this.add),this.util.addEvent(window,"touchmove",this.add),this},n}(),e.Waltz||(e.Waltz=n)}).call(this);